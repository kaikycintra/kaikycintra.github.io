#!/bin/bash

# Run the checkdate script silently
./scripts/checkdate.sh > /dev/null

# Check if the "Last Updated" date is current
if ! ./scripts/checkdate.sh | grep -q "already current"; then
    echo "❌ Push aborted: 'Last Updated' date is not current."
    echo "➡️  Please run ./dev changedate"
    exit 1
fi

# Compare index.html and 404.html in the last commit (HEAD)
if ! git diff --quiet HEAD:index.html HEAD:404.html; then
    echo "❌ Push aborted: index.html and 404.html differ in the last commit."
    echo "➡️  Please run ./dev 404 and amend the commit"
    exit 1
fi

echo "✅ Pre-push checks passed."
exit 0
